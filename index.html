<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EL SARGENGO</title>
    <style>
        :root { --bg: #0d0d0d; --mil: #ff9800; --danger: #ff0000; }
        body { font-family: 'Courier New', monospace; background: var(--bg); color: #eee; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .app { width: 90%; max-width: 380px; background: #1a1a1a; padding: 20px; border: 3px solid var(--mil); text-align: center; }
        h1 { color: var(--mil); border-bottom: 2px solid var(--mil); padding-bottom: 10px; margin: 0; }
        .btn { background: var(--mil); color: #000; border: none; padding: 15px; width: 100%; font-weight: bold; cursor: pointer; margin-top: 20px; text-transform: uppercase; }
        .box { width: 150px; height: 150px; border: 3px double var(--mil); margin: 20px auto; display: flex; align-items: center; justify-content: center; font-weight: bold; }
        #timer { font-size: 2rem; color: var(--mil); display: none; }
        .flash { animation: shake 0.1s infinite; background: var(--danger) !important; }
        @keyframes shake { 0% { transform: translate(2px, 2px); } 50% { transform: translate(-2px, -2px); } 100% { transform: translate(2px, -2px); } }
    </style>
</head>
<body>

<div class="app" id="ui">
    <h1>EL SARGENGO</h1>
    <p>CHISPAS: <span id="r">0</span></p>
    
    <select id="c" style="width:100%; background:#000; color:var(--mil); padding:10px; border:1px solid var(--mil);">
        <option value="d">CASA (ORDEN)</option>
        <option value="e">CUERPO (SUDOR)</option>
        <option value="t">MENTE (ENFOQUE)</option>
    </select>

    <div class="box">
        <div id="timer">05:00</div>
        <span id="txt">ESPERANDO</span>
    </div>

    <p id="ins" style="font-weight:bold; min-height:40px;">¿VAS A MOVERTE?</p>

    <button id="b1" class="btn">¡RECIBIR ORDEN!</button>
    <button id="b2" class="btn" style="display:none; background:#2e7d32; color:#fff;">¡ORDEN CUMPLIDA!</button>
</div>

<script>
    const m = {
        d: ["LIMPIA TU MESA", "HAZ LA CAMA", "TIRA LA BASURA"],
        e: ["20 FLEXIONES", "1 MIN PLANCHA", "30 SENTADILLAS"],
        t: ["LEE 5 PÁGINAS", "PLANIFICA EL DÍA", "ESTUDIA 10 MIN"]
    };

    let racha = localStorage.getItem('s_r') || 0;
    document.getElementById('r').innerText = racha;
    let n = 0;

    document.getElementById('b1').onclick = function() {
        let h = new Date().getHours();
        
        // SUSTO NOCTURNO (23:00 a 05:00)
        if (h >= 23 || h < 5) {
            n++;
            if (n === 1) {
                alert("¿QUÉ HACES DESPIERTO? VE A DORMIR. ÚLTIMO AVISO.");
            } else {
                document.body.classList.add('flash');
                document.getElementById('ui').style.display = 'none';
                setTimeout(() => {
                    alert("¡TE DIJE QUE DORMIRAS! RACHA BORRADA.");
                    localStorage.setItem('s_r', 0);
                    location.reload();
                }, 400);
                return;
            }
        }

        let cat = document.getElementById('c').value;
        document.getElementById('ins').innerText = m[cat][Math.floor(Math.random()*3)];
        this.style.display = 'none';
        document.getElementById('b2').style.display = 'block';
        document.getElementById('timer').style.display = 'block';
        document.getElementById('txt').style.display = 'none';
        
        let t = 300;
        setInterval(() => {
            if(t > 0) {
                t--;
                let min = Math.floor(t/60), seg = t%60;
                document.getElementById('timer').innerText = min + ":" + (seg<10?'0':'') + seg;
            } else {
                alert("¡FRACASASTE!");
                localStorage.setItem('s_r', 0);
                location.reload();
            }
        }, 1000);
    };

    document.getElementById('b2').onclick = function() {
        racha++;
        localStorage.setItem('s_r', racha);
        alert("BIEN HECHO.");
        location.reload();
    };
</script>
</body>
</html>
